<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;trioClasses&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;GWASTools&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;CleftCNVAssoc&quot;</span>)</code></pre>
<p>First we create a vector of offspring IDs that we want plotted.</p>
<pre class="sourceCode r"><code class="sourceCode r">offspring.vec &lt;- <span class="kw">as.character</span>(<span class="kw">completeTrios</span>(fe.beaty)$id)</code></pre>
<p>Now we incorporate it into a GRange object with the ranges in this case being the chr7 region for each of the offspring.</p>
<pre class="sourceCode r"><code class="sourceCode r">gr &lt;- <span class="kw">GRanges</span>(<span class="dt">seqnames =</span> <span class="kw">rep</span>(<span class="st">&quot;chr7&quot;</span>, <span class="kw">length</span>(offspring.vec)), <span class="dt">ranges =</span> <span class="kw">IRanges</span>(<span class="dt">start =</span> <span class="dv">141419097</span>, 
    <span class="dt">end =</span> <span class="dv">141441259</span>), <span class="dt">id =</span> offspring.vec)</code></pre>
<p>Now we apply a function from CleftCNVAssoc to retrieve data from GWASTools objects. These data exist only on an encrypted hard drive and enigma.</p>
<pre class="sourceCode r"><code class="sourceCode r">raw.df.list &lt;- <span class="kw">getRaw</span>(gr + <span class="fl">1e+06</span>, <span class="dt">intensfile =</span> intensfile, <span class="dt">snpAnnot =</span> beaty_snpAnnot, 
    <span class="dt">scan.id =</span> scan.ids, <span class="dt">fa.id =</span> fa.id, <span class="dt">ma.id =</span> ma.id, <span class="dt">genofile =</span> genofile, <span class="dt">xyfile =</span> xyfile)</code></pre>
<p>Here are the data for the first offspring's first 5 markers.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(raw.df.list[[<span class="dv">1</span>]], <span class="dv">5</span>)</code></pre>
<pre><code>     logr    baf       pos logr.fa logr.ma baf.fa baf.ma geno geno.fa
1 -0.1648 0.5189 140422294 -0.2148 -0.0340 0.0011 1.0000    1       2
2 -0.0777 0.0069 140423362 -0.0257 -0.0588 0.0041 0.0040   NA      NA
3  0.0018 0.9972 140426209  0.1944  0.0264 0.5048 1.0000    0       1
4  0.0450 0.5078 140426359  0.0468  0.1053 0.0000 0.4995    1       2
5  0.0962 0.9957 140433319 -0.0501 -0.0142 1.0000 1.0000   NA      NA
  geno.ma     x     y  x.fa  y.fa  x.ma  y.ma     snpname
1       0 0.762 0.839 1.261 0.016 0.054 1.377    rs498933
2      NA 0.646 0.032 0.673 0.031 0.657 0.030 cnvi0014408
3       0 0.012 0.907 0.585 0.641 0.000 0.932    rs557962
4       1 0.982 0.869 1.600 0.012 1.041 0.896   rs4726259
5      NA 0.018 0.611 0.008 0.561 0.010 0.573 cnvi0014398</code></pre>
<p>Plot the logR values for everyone stratified by F,M,O. Purple is offspring, red is father, and blue is mother.</p>
<p>Not very informative so we turn to individual trios with an untransmitted deletion. First, we need to find a vector offspring IDs with an untransmitted deletion. This is a property of the CNVMatrix within the FamilyExperiment object and can be manipulated with the non-exported method TrioAssay. To begin we first subset the CNVMatrix on the chr7 region.</p>
<pre class="sourceCode r"><code class="sourceCode r">chr7.gr &lt;- <span class="kw">GRanges</span>(<span class="dt">seqnames =</span> <span class="st">&quot;chr7&quot;</span>, <span class="dt">ranges =</span> <span class="kw">IRanges</span>(<span class="dt">start =</span> <span class="dv">141419097</span>, <span class="dt">end =</span> <span class="dv">141441259</span>))

(fe.beaty.chr7 &lt;- fe.beaty[<span class="kw">queryHits</span>(<span class="kw">findOverlaps</span>(<span class="kw">rowData</span>(fe.beaty), chr7.gr))])</code></pre>
<pre><code>class: FamilyExperiment 
dim: 8 1339 
exptData(0):
assays(1): cnv
rownames(8): comp3086 comp3087 ... comp3092 comp3093
rowData metadata column names(0):
colnames(1339): 11005_01@1008472480 11005_02@1008472482 ...
  18117_02@0070298660 18117_03@0070298657
colData names(1): id
pedigree(2082): famid id fid mid sex dx
complete trios(445):</code></pre>
<p>Now with the smaller FE object we can easily construct the trio-states.</p>
<pre class="sourceCode r"><code class="sourceCode r">trioAssay.chr7 &lt;- trioClasses:::<span class="kw">TrioAssay</span>(fe.beaty.chr7, <span class="dt">type =</span> <span class="st">&quot;cnv&quot;</span>)
trioStates.chr7 &lt;- <span class="kw">with</span>(trioAssay.chr7, <span class="kw">matrix</span>(<span class="kw">paste0</span>(F, M, O), <span class="dt">nrow =</span> <span class="kw">nrow</span>(O), 
    <span class="dt">ncol =</span> <span class="kw">ncol</span>(O)))
<span class="kw">dimnames</span>(trioStates.chr7) &lt;- <span class="kw">dimnames</span>(trioAssay.chr7$O)
<span class="co"># head(trioStates.chr7[,1:5],10)</span></code></pre>
<p>Now we identify trio-cnv pairs with an untransmitted deletion, i.e., trio-states 100, 010, or 110. (This is not a complete list of trio-states with a non-transmission.)</p>
<pre class="sourceCode r"><code class="sourceCode r">untrans.mat &lt;- <span class="kw">matrix</span>(trioStates.chr7 %in% <span class="kw">c</span>(<span class="st">&quot;100&quot;</span>, <span class="st">&quot;010&quot;</span>, <span class="st">&quot;110&quot;</span>), <span class="dt">nrow =</span> <span class="kw">nrow</span>(trioStates.chr7), 
    <span class="dt">ncol =</span> <span class="kw">ncol</span>(trioStates.chr7), <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">dimnames =</span> <span class="kw">dimnames</span>(trioStates.chr7))
<span class="kw">head</span>(untrans.mat[, <span class="dv">1</span>:<span class="dv">10</span>], <span class="dv">10</span>)</code></pre>
<pre><code>Error: error in evaluating the argument &#39;x&#39; in selecting a method for
function &#39;head&#39;: Error in untrans.mat[, 1:10] (from &lt;text&gt;#3) : subscript
out of bounds</code></pre>
<p>And finally we find the IDs of those with more than zero untransmitted deletions.</p>
<pre class="sourceCode r"><code class="sourceCode r">offspring.chr7 &lt;- <span class="kw">rownames</span>(untrans.mat)[<span class="kw">which</span>(<span class="kw">rowSums</span>(untrans.mat) &gt; <span class="dv">0</span>)]
<span class="kw">length</span>(offspring.chr7)</code></pre>
<pre><code>[1] 44</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(offspring.chr7)</code></pre>
<pre><code>[1] &quot;12004_01@1008489060&quot; &quot;12026_01@1008490128&quot; &quot;12036_01@1008494873&quot;
[4] &quot;12043_01@1008494947&quot; &quot;12071_01@0067868170&quot; &quot;12074_01@0067868244&quot;</code></pre>
<p>Now we have what we need to dig deeper into the cause of the under-transmission. <img src="figures/logrplot2-chr71.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr72.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr73.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr74.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr75.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr76.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr77.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr78.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr79.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr710.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr711.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr712.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr713.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr714.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr715.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr716.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr717.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr718.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr719.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr720.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr721.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr722.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr723.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr724.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr725.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr726.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr727.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr728.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr729.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr730.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr731.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr732.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr733.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr734.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr735.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr736.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr737.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr738.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr739.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr740.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr741.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr742.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr743.png" alt="plot of chunk logrplot2-chr7" /> <img src="figures/logrplot2-chr744.png" alt="plot of chunk logrplot2-chr7" /></p>
<p>Now for the transmitted deletions in the chr7 region.</p>
<pre class="sourceCode r"><code class="sourceCode r">trans.mat &lt;- <span class="kw">matrix</span>(trioStates.chr7 %in% <span class="kw">c</span>(<span class="st">&quot;101&quot;</span>, <span class="st">&quot;011&quot;</span>, <span class="st">&quot;112&quot;</span>), <span class="dt">nrow =</span> <span class="kw">nrow</span>(trioStates.chr7), 
    <span class="dt">ncol =</span> <span class="kw">ncol</span>(trioStates.chr7), <span class="dt">byrow =</span> <span class="ot">FALSE</span>, <span class="dt">dimnames =</span> <span class="kw">dimnames</span>(trioStates.chr7))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">offspring.chr7 &lt;- <span class="kw">rownames</span>(trans.mat)[<span class="kw">which</span>(<span class="kw">rowSums</span>(trans.mat) &gt; <span class="dv">0</span>)]
<span class="kw">length</span>(offspring.chr7)</code></pre>
<pre><code>[1] 62</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(offspring.chr7)</code></pre>
<pre><code>[1] &quot;12037_01@1008494916&quot; &quot;12040_01@1008494922&quot; &quot;12059_01@1008494932&quot;
[4] &quot;12091_01@0067866342&quot; &quot;12099_01@0067866249&quot; &quot;12107_01@0067866336&quot;</code></pre>
<p><img src="figures/logrplot3-chr71.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr72.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr73.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr74.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr75.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr76.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr77.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr78.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr79.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr710.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr711.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr712.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr713.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr714.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr715.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr716.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr717.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr718.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr719.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr720.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr721.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr722.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr723.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr724.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr725.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr726.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr727.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr728.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr729.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr730.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr731.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr732.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr733.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr734.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr735.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr736.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr737.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr738.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr739.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr740.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr741.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr742.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr743.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr744.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr745.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr746.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr747.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr748.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr749.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr750.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr751.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr752.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr753.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr754.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr755.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr756.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr757.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr758.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr759.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr760.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr761.png" alt="plot of chunk logrplot3-chr7" /> <img src="figures/logrplot3-chr762.png" alt="plot of chunk logrplot3-chr7" /></p>
