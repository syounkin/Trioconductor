% Sweave(file = "./trioClasses.Rnw")
\documentclass[10pt]{article}

\usepackage{fullpage}
\usepackage{times}
\usepackage[colorlinks=TRUE,urlcolor=blue,citecolor=blue]{hyperref}
\title{Classes \emph{SNPExperiment} and \emph{CNVExperiment}: Derivatives of \emph{SummarizedExperiment} for use with genotype and intensity data in package \emph{trioClasses}}
\author{Samuel G. Younkin}
\date{\today}
%\input{/home/bst/student/syounkin/jhsph/latex/sgy}
%\input{/home/sgy/jhsph/latex/sgy}
\usepackage{Sweave}
\begin{document}
\setlength{\parskip}{0.2\baselineskip}
\setlength{\parindent}{0pt}
\maketitle
\begin{Schunk}
\begin{Sinput}
> library("trioClasses")
> library("vcf2R")
> data(targets)
> data("BMP4-european-all.sm")
> df <- DataFrame(dx = rep(1, 10), sex = rep(1, 10), row.names = paste0("sub", 
     1:10))
> class(df)
\end{Sinput}
\begin{Soutput}
[1] "DataFrame"
attr(,"package")
[1] "IRanges"
\end{Soutput}
\begin{Sinput}
> class(sm)
\end{Sinput}
\begin{Soutput}
[1] "SnpMatrix"
attr(,"package")
[1] "snpStats"
\end{Soutput}
\begin{Sinput}
> logR <- matrix(runif(130), nrow = 13, ncol = 10)
> baf <- matrix(runif(130), nrow = 13, ncol = 10)
\end{Sinput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> (snpEx <- new("SNPTrioExperiment", pedigree = new("PedClass", 
     ped.df), assays = SimpleList(geno = sm[1:13, 1:10], 
     logR = logR, baf = baf), colData = df, rowData = targets.gr))
\end{Sinput}
\begin{Soutput}
class: SNPTrioExperiment 
dim: 13 10 
exptData(0):
assays(3): geno logR baf
rownames(13): IRF6 MAFB ... FGFR2 PTCH1
rowData values names(0):
colnames(10): sub1 sub2 ... sub9 sub10
colData names(2): dx sex
\end{Soutput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> class(snpEx@pedigree)
\end{Sinput}
\begin{Soutput}
[1] "PedClass"
attr(,"package")
[1] "trioClasses"
\end{Soutput}
\begin{Sinput}
> class(geno(snpEx))
\end{Sinput}
\begin{Soutput}
[1] "SnpMatrix"
attr(,"package")
[1] "snpStats"
\end{Soutput}
\begin{Sinput}
> class(logR(snpEx))
\end{Sinput}
\begin{Soutput}
[1] "matrix"
\end{Soutput}
\begin{Sinput}
> class(baf(snpEx))
\end{Sinput}
\begin{Soutput}
[1] "matrix"
\end{Soutput}
\end{Schunk}
\begin{Schunk}
\begin{Sinput}
> pedigree(snpEx)
\end{Sinput}
\begin{Soutput}
An object of class "PedClass"
Slot "pedigree":
   pedid    id  fid  mid sex dx
1      1  sub1    0    0   1  1
2      1  sub2    0    0   2  1
3      1  sub3 sub1 sub2   2  1
4      2  sub4    0    0   1  1
5      2  sub5    0    0   2  1
6      2  sub6 sub4 sub5   2  1
7      3  sub7    0    0   1  1
8      3  sub8    0    0   2  1
9      3  sub9 sub7 sub8   2  1
10     4 sub10    0    0   1  1
\end{Soutput}
\begin{Sinput}
> completeTrios(snpEx)
\end{Sinput}
\begin{Soutput}
  pedid   id  fid  mid sex dx
3     1 sub3 sub1 sub2   2  1
6     2 sub6 sub4 sub5   2  1
9     3 sub9 sub7 sub8   2  1
\end{Soutput}
\end{Schunk}
\end{document}
